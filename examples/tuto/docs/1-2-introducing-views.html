<!DOCTYPE html>  <html> <head>   <title>1-2-introducing-views.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="1-1-getting-started.html">                 1-1-getting-started.js               </a>                                           <a class="source" href="1-2-introducing-views.html">                 1-2-introducing-views.js               </a>                                           <a class="source" href="1-3-introducing-models.html">                 1-3-introducing-models.js               </a>                                           <a class="source" href="1-4-using-it-all-together.html">                 1-4-using-it-all-together.js               </a>                                           <a class="source" href="index.html">                 index.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               1-2-introducing-views.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><strong>This example illustrates the declaration and instantiation of a simple View</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p><a href="1-3-introducing-models.html" class="button">Go to Introducing models</a></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Just as routers, View instances get request/response/next to manipulate the response or optionnally pass control over the next middleware. <em>Note that they're correctly sey up if the view is attached to the corresponding Router, usually done in the Router's initialize method.</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Backnode</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;backnode&#39;</span><span class="p">),</span>
<span class="nx">connect</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;connect&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p><strong>View class</strong>: Our main app view.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">View</span> <span class="o">=</span> <span class="nx">Backnode</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>templates are internally (when instantiated) resolved as the file content. The value specified is the relative path to the template file.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;templates/index.html&#39;</span><span class="p">,</span>
  </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p><code>render()</code>: Function in charge of handling the response output. Views generally defines a render method to end the response. Potentially, any template engine could be used. Here, we only replace the <code>{{foobar}}</code> hook with value.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{{foobar}}&#39;</span><span class="p">,</span> <span class="s1">&#39;Foobar&#39;</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p><strong>Router class</strong>: Our main app router.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Backnode</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">routes</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="o">:</span> <span class="s1">&#39;index&#39;</span>
  <span class="p">},</span>
  </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p><code>initialize()</code>: This is where the View is instantiated. Usually, it gets attached to the instance property to easily acces them later in actions. Plus, this is mandatory for views to be able to acts on a response object. If any of the Router property is a View, they get request/response/next and are kept up to date upon each incoming request. </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">View</span><span class="p">();</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p><code>index()</code>: Now that we have a view to work with, call its render method to end the response. Remember that actions must either end the response or <code>this.next()</code> to the following middleware, otherwise the request will hang out indefinitely.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">index</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">connect</span><span class="p">.</span><span class="nx">createServer</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">connect</span><span class="p">.</span><span class="nx">logger</span><span class="p">(</span><span class="s1">&#39;:method :url :status :res[content-length] - :response-time ms&#39;</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Backnode</span><span class="p">(</span><span class="k">new</span> <span class="nx">Router</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">connect</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">8080</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Server started, up and running on port 8080&#39;</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 